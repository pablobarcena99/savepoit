<div>
  <h2> Your friends </h2>
</div>

<div>
  <% @friends.each do |friendship| %>
    <% if friendship.receiver_id == @user.id %>
        <div>
          <%= User.find(friendship.requester_id).username %>
        </div>
    <% else %>
      <div>
          <%= User.find(friendship.receiver_id).username %>
        </div>
    <% end %>
  <% end %>

</div>

<div>
 <h2> Friend requests </h2>
</div>
<% @pending_friends.each do |friendship| %>
  <div>
    <%= User.find(friendship.requester_id).username %>
    <%= link_to "Accept", accept_friendship_path(friendship), method: 'patch' %>
    <%= link_to "Reject", reject_friendship_path(friendship), method: 'patch' %>
  </div>
<% end %>


<div>
  <h2> Make a friend request </h2>
</div>
<% current_user.not_friends.each do |friend| %>
  <div>
    <%= friend.username %>
    <%= friend.id %>

    <%= simple_form_for(@friendship) do |f| %>
      <%= f.hidden_field :receiver_id, value: friend.id %>

      <% if Friendship.where(requester: current_user, receiver: friend).empty? && Friendship.where(receiver: current_user, requester: friend).empty? %>
        <%= f.submit "Follow" %>
      <% else %>
        <%= f.submit 'Pending', disabled: true %>
      <% end %>
    <% end %>
  </div>
<% end %>
